{% extends "base.html" %}

{% block title %}导入Excel - 课程提醒助手{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-upload"></i> 导入Excel课表</h4>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <h5><i class="bi bi-info-circle"></i> Excel格式要求</h5>
                    <p class="mb-0">Excel文件需要包含以下列：</p>
                    <ul class="mt-2 mb-0">
                        <li><strong>课程名称</strong> - 课程的名称</li>
                        <li><strong>星期</strong> - 1-7（周一到周日）或"周一"、"Tuesday"等</li>
                        <li><strong>开始时间</strong> - 如：08:00、9:30</li>
                        <li><strong>结束时间</strong> - 如：09:40、11:00</li>
                        <li><strong>地点</strong>（可选）- 上课地点</li>
                        <li><strong>备注</strong>（可选）- 课程备注信息</li>
                    </ul>
                </div>

                <div class="text-center mb-4">
                    <a href="/api/template" class="btn btn-outline-primary">
                        <i class="bi bi-download"></i> 下载Excel模板
                    </a>
                </div>

                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="excelFile" class="form-label">选择Excel文件</label>
                        <input type="file" class="form-control form-control-lg" id="excelFile" name="file" 
                               accept=".xlsx,.xls" required>
                        <div class="form-text">支持 .xlsx 和 .xls 格式</div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg" id="uploadBtn">
                            <i class="bi bi-cloud-upload"></i> 上传并导入
                        </button>
                        <a href="/" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left"></i> 返回课程列表
                        </a>
                    </div>
                </form>

                <div id="uploadResult" class="mt-4" style="display: none;">
                    <div class="alert" role="alert">
                        <div id="uploadMessage"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <i class="bi bi-table"></i> 示例数据格式
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-sm">
                        <thead class="table-light">
                            <tr>
                                <th>课程名称</th>
                                <th>星期</th>
                                <th>开始时间</th>
                                <th>结束时间</th>
                                <th>地点</th>
                                <th>备注</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>高等数学</td>
                                <td>周一</td>
                                <td>08:00</td>
                                <td>09:40</td>
                                <td>教学楼A101</td>
                                <td>带教材</td>
                            </tr>
                            <tr>
                                <td>大学英语</td>
                                <td>2</td>
                                <td>14:00</td>
                                <td>15:40</td>
                                <td>教学楼B203</td>
                                <td>准备演讲</td>
                            </tr>
                            <tr>
                                <td>计算机基础</td>
                                <td>Wednesday</td>
                                <td>10:00</td>
                                <td>11:40</td>
                                <td>实验楼C305</td>
                                <td>实验报告</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="text-muted small mb-0">
                    <i class="bi bi-lightbulb"></i> 
                    提示：星期列支持多种格式（1-7数字、周一/周二、Monday/Tuesday等）
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
